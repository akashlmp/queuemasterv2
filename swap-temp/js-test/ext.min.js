var BASE_URL="https://queuing.walkingdreamz.com/api/";const FingerprintJS_URL="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js";let totalDuration=60,progressBar=document.getElementById("ie1np"),interval=1e3,remainTime=60,width=0,timer,already_in=!1;var browserDataGloble={},setTimeoutLoop=1e3;function loadFingerprintJS(){return new Promise((resolve,reject)=>{let xhr=new XMLHttpRequest;xhr.open("GET",FingerprintJS_URL,!0),xhr.onreadystatechange=function(){if(4===xhr.readyState){if(200===xhr.status)try{eval(xhr.responseText),"undefined"!=typeof FingerprintJS?resolve(FingerprintJS):reject(Error("FingerprintJS is undefined after evaluation"))}catch(error){reject(Error("Error evaluating FingerprintJS script: "+error.message))}else reject(Error("Failed to fetch the FingerprintJS library: "+xhr.statusText))}},xhr.send()})}async function getFingerPrintId(){try{let e=await loadFingerprintJS(),t=await e.load(),i=await t.get(),o=i.visitorId;return o}catch(s){console.error("Error loading FingerprintJS:",s)}}function generateSessionId(){return String(Date.now())}function setCookie(e,t,i){var o=new Date;o.setTime(o.getTime()+6e4*i);var s="expires="+o.toUTCString();document.cookie=`${e}=${t};${s};path=/`}function getCookie(e){var t=e+"=",i=decodeURIComponent(document.cookie).split(";");for(let o=0;o<i.length;o++){let s=i[o];for(;" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(t))return s.substring(t.length,s.length)}return null}async function executeScript(e){var t,i={userAgent:navigator.userAgent,language:navigator.language,cookiesEnabled:navigator.cookieEnabled,platform:navigator.platform,vendor:navigator.vendor,browserPlugins:Array.from(navigator.plugins,e=>({name:e.name,filename:e.filename}))},o={encodedURL:window.location.href,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,browserLanguage:navigator.language,ipaddress:await fetchIPAddress(),deviceid:await getFingerPrintId(),browserTime:new Date().toLocaleTimeString()},s={connectionType:navigator.connection?navigator.connection.type:"Connection API not supported",online:navigator.onLine,userAgentHttpHeaders:navigator.userAgent,mobile:/Mobile|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),platform:navigator.platform},r=getPerformanceMetrics();sendData({browser:i,miscellaneous:o,networkInformation:s,performanceMetrics:r,scriptAttributes:e,cookies:getCookies()})}async function fetchIPAddress(){try{return(await (await fetch("https://api.ipify.org?format=json")).json()).ip}catch(e){return console.error("Error fetching IP address:",e),null}}function getPerformanceMetrics(){var e={navigationTiming:performance.timing.toJSON(),navigationType:performance.navigation.type,navigationRedirectCount:performance.navigation.redirectCount};return performance.memory&&(e.memoryUsage={totalJSHeapSize:performance.memory.totalJSHeapSize,usedJSHeapSize:performance.memory.usedJSHeapSize,jsHeapSizeLimit:performance.memory.jsHeapSizeLimit}),e}function getCookies(){var e={};return document.cookie.split(";").forEach(t=>{var[i,o]=t.trim().split("=");e[i]=o}),e}function sendData(e){var t=new XMLHttpRequest;t.open("POST",BASE_URL+"get-browser-data",!0),t.setRequestHeader("Content-Type","application/json");let i=window.location.href;t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){if(200===t.status){var o=t.responseText,s=JSON.parse(o.substring(o.indexOf("{")));if(1==s.status||10==s.status)return!1===s.qProcessOp&&(deleteCookie("qProcessOp"),deleteCookie("preQueue"),deleteCookie("qSessionId"),deleteCookie("checkByepassStatus")),console.log(i),i!==s.redirectionUrl&&(window.location.href=s.redirectionUrl),!1;if(4==s.status){var r=getCookies();!0!==r.preQueue&&setCookie("preQueue",!0,30),showForcePopup(s.htmlBody,s.status);var n={session_id:e.cookies.qSessionId,scriptAttributes:e.scriptAttributes,ipaddress:e.miscellaneous.ipaddress,deviceid:e.miscellaneous.device_id};executeQueueOpByPass(n)}else if(2==s.status){var r=getCookies();!0!==r.checkByepassStatus&&setCookie("checkByepassStatus",!0,30),!0!==r.qProcessOp&&setCookie("qProcessOp",!0,30),showForcePopupForForm(s.htmlBody);var n={session_id:e.cookies.qSessionId,scriptAttributes:e.scriptAttributes,ipaddress:e.miscellaneous.ipaddress,deviceid:e.miscellaneous.device_id};checkBypassCodeStatus(n)}else{if(!0===s.qProcessOp){var r=getCookies();!0!==r.qProcessOp&&setCookie("qProcessOp",!0,30)}var n={session_id:e.cookies.qSessionId,scriptAttributes:e.scriptAttributes,ipaddress:e.miscellaneous.ipaddress,deviceid:e.miscellaneous.device_id};executeQueueOp(n)}}else deleteCookie("qProcessOp"),deleteCookie("preQueue"),deleteCookie("qSessionId"),deleteCookie("checkByepassStatus")}},t.send(JSON.stringify(e))}function deleteCookie(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"}function showForcePopup(e,t=null){if(5===t){e+="<style>#iyb66 #ie1np {width: var(--progress);height: 100%;background-image: initial;background-position-x: initial;background-position-y: initial;background-size: initial;background-attachment: initial;background-origin: initial;background-clip: initial;background-repeat: repeat;transition-duration: none;transition-timing-function: none;transition-delay: none;transition-property: none;--progress: 0%;}</style>",document.documentElement.innerHTML="";var i=document.createElement("div");i.id="popup-container",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.backgroundColor="rgba(0, 0, 0, 0.5)",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center";var o=document.createElement("div");o.id="popup-modal",o.innerHTML=e,o.style.width="100%",i.appendChild(o),document.body.appendChild(i),ProgressBar()}else{document.documentElement.innerHTML="";var i=document.createElement("div");i.id="popup-container",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.backgroundColor="rgba(0, 0, 0, 0.5)",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center";var o=document.createElement("div");o.id="popup-modal",o.innerHTML=e,o.style.width="100%",i.appendChild(o),document.body.appendChild(i)}}function showForcePopupForForm(e){document.documentElement.innerHTML="",console.log("htmlBody");var t=document.createElement("div");t.id="popup-container",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0, 0, 0, 0.5)",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center";var i=document.createElement("div");i.id="popup-modal",i.innerHTML=e,i.style.width="100%",t.appendChild(i),document.body.appendChild(t)}function ProgressBar(){progressBar=document.getElementById("ie1np");var e=parseInt(getCookie("progressWidth"));e&&(width=e),width<100&&(timer=setInterval(updateProgressBar,interval))}async function updateProgressBar(){if(width>=100)clearInterval(timer),await executeQueueOp(browserDataGloble);else{(width+=100/totalDuration)>=100&&(width=100),deleteCookie("progressWidth");var e=parseInt(totalDuration/60);setCookie("progressWidth",!1,e),setCookie("progressWidth",width,e),(setTimeoutLoop+=1e3)>45e3&&(setTimeoutLoop=1e3),setCookie("refreshAjax",setTimeoutLoop,e),remainTime-=1,progressBar.style.setProperty("--progress",`${width}%`),progressBar.style.width=width+"%",progressBar.setAttribute("aria-valuenow",width),remainTime<60?document.getElementById("i378h").innerHTML="Few Seconds left":document.getElementById("i378h").innerHTML=Math.round(remainTime/60)+" mins"}}async function executeQueueOp(e){var t=new XMLHttpRequest;t.open("POST",BASE_URL+"q-operations",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){if(200===t.status){var i=t.responseText,o=JSON.parse(i.substring(i.indexOf("{")));if(console.log(o.status),0===o.status)return!1;if(2==o.status)showForcePopupForForm(o.htmlBody),checkBypassCodeStatus(recursive_data);else if(4==o.status){var s=getCookies();return!0!==s.preQueue&&setCookie("preQueue",!0,30),showForcePopup(o.htmlBody,o.status),!0}else if(1==o.status||6==o.status||10==o.status){if(!1===o.qProcessOp){deleteCookie("qProcessOp"),deleteCookie("preQueue"),deleteCookie("checkByepassStatus"),deleteCookie("qSessionId");var s=getCookies();!0!==s.preQueue&&(setCookie("same_target_flag",!0,30),deleteCookie("refreshAjax"),deleteCookie("progressWidth"))}return!1!==o.redirectionUrl&&(window.location.href=o.redirectionUrl),!0}else clearInterval(timer),showForcePopup(o.htmlBody),void 0!==o.current_queue_pos&&(!1==already_in&&(already_in=!0,totalDuration*=Math.round(o.current_queue_pos/o.max_traffic_visitor),remainTime=totalDuration),document.getElementById("ifw5q").innerHTML=o.current_queue_pos,remainTime<60?document.getElementById("i378h").innerHTML="Few Seconds left":document.getElementById("i378h").innerHTML=Math.round(remainTime/60)+" mins");console.log(e),browserDataGloble=e;var r=45e3,n=parseInt(getCookie("refreshAjax"));n&&(console.log(n),console.log("delete - refreshAjax"),r-=n,deleteCookie("refreshAjax")),setTimeout(async function(){await executeQueueOp(e)},r)}else deleteCookie("qProcessOp"),deleteCookie("preQueue"),deleteCookie("checkByepassStatus"),deleteCookie("qSessionId"),console.error("Request failed with status:",t.status)}};var i=await getFingerPrintId();t.send(JSON.stringify({...e,deviceid:i}))}async function executeQueueOpByPass(e){var t=new XMLHttpRequest;t.open("POST",BASE_URL+"q-operations",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){if(200===t.status){var i=t.responseText,o=JSON.parse(i.substring(i.indexOf("{")));if(0===o.status)return!1;if(2==o.status)showForcePopupForForm(o.htmlBody),checkBypassCodeStatus(recursive_data);else if(4==o.status){showForcePopup(o.htmlBody);var s=getCookies();!0!==s.preQueue&&setCookie("preQueue",!0,30)}else if(1==o.status||6==o.status||10==o.status){if(!1===o.qProcessOp){deleteCookie("qProcessOp"),deleteCookie("preQueue"),deleteCookie("checkByepassStatus"),deleteCookie("qSessionId");var s=getCookies();!0!==s.preQueue&&(setCookie("same_target_flag",!0,30),deleteCookie("refreshAjax"),deleteCookie("progressWidth"))}return!1!==o.redirectionUrl&&(window.location.href=o.redirectionUrl),!0}else showForcePopup(o.htmlBody);setTimeout(async function(){await executeQueueOpByPass(e)},45e3)}else deleteCookie("qProcessOp"),deleteCookie("preQueue"),deleteCookie("checkByepassStatus"),deleteCookie("qSessionId"),console.error("Request failed with status:",t.status)}},t.send(JSON.stringify(e))}async function checkBypassCodeStatus(e){var t=new XMLHttpRequest;t.open("POST",BASE_URL+"check-bypass-code-status",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){if(200===t.status){var i=t.responseText,o=JSON.parse(i.substring(i.indexOf("{")));1==o.status?executeQueueOp(e):(showForcePopupForForm(o.htmlBody),setTimeout(async function(){await checkBypassCodeStatus(e)},45e3))}else console.error("Request failed with status:",t.status)}},t.send(JSON.stringify(e))}document.addEventListener("DOMContentLoaded",async()=>{var e=document.querySelector("script[data-intercept]");if(e){var t=getCookie("same_target_flag");if(console.log(t),t)deleteCookie("qProcessOp"),deleteCookie("preQueue"),deleteCookie("checkByepassStatus"),deleteCookie("qSessionId"),console.log("same target site");else{var i=getCookie("qSessionId");console.log(i);var o=getCookie("preQueue"),s=getCookie("checkByepassStatus"),r={domain:e.dataset.interceptDomain,intercept:e.dataset.intercept,cid:e.dataset.c};if(s&&i)await checkBypassCodeStatus({session_id:i,scriptAttributes:r,deviceid:await getFingerPrintId()});else{var n=getCookie("qProcessOp");if(console.log("qProcessOp"),console.log(n),n&&i)o&&i?await executeQueueOpByPass({session_id:i,scriptAttributes:r,deviceid:await getFingerPrintId()}):await executeQueueOp({session_id:i,scriptAttributes:r,deviceid:await getFingerPrintId()});else if(console.log(o),o&&i)await executeQueueOpByPass({session_id:i,scriptAttributes:r,deviceid:await getFingerPrintId()});else{deleteCookie("qProcessOp"),deleteCookie("preQueue"),deleteCookie("checkByepassStatus"),deleteCookie("qSessionId");let a=generateSessionId();setCookie("qSessionId",a,30),await executeScript(r)}}}}else console.error("Script element with data-intercept attribute not found.")});